This template is meant to be used for an individual microservice, so it could be used multiple times in the same project for different microservices each time.

---

#### To use this template clone it with cookiecutter:

1. Install the `cookiecutter` library if it isn't already installed:
   `pip3 install cookiecutter`

2. Use this cookiecutter template: `cookiecutter gh:andrewguest/cookiecutter-fastapi-mongodb-microservice`

3. Answer the questions when prompted (example below):

| Prompt                                                            | Explanation                                                                                                                                                                      |
| ----------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `microservice_name []`                                            | Name for this microservice                                                                                                                                                       |
| `microservice_slug [cart-microservice]`                           | This will be automatically generated by lowercasing your project name and replacing any space with a hyphen. You can just press enter here to use the default microservice_slug. |
| `mongodb_database [example_db]`                                   | The name of the database, within MongoDB, to create.                                                                                                                             |
| `mongodb_collection [example_collection]`                         | The name of the MongoDB collection, within the {{cookiecutter.mongodb_database}} database, to create.                                                                            |
| `mongodb_new_username [changeme]`                                 | The default username for the new MongoDB setup.                                                                                                                                  |
| `mongodb_new_username_password [changeme]`                        | The default password for the {{cookiecutter.mongodb_username}} user.                                                                                                             |
| `mongodb_local_storage [/tmp/{{cookiecutter.microservice_slug}}]` | What path, on the host machine, do you want to mount into the MongoDB container for it to (persistantly) store data?                                                             |
| `api_port [5050]`                                                 | What port would you like the API container to listen on?                                                                                                                         |
| `gunicorn_uvicorn_workers [1]`                                    | How many uvicorn worker processes would you like gunicorn to start? More workers means your app can handle more traffic, but will use more resources.                            |

4. Start this service (these two containers): `docker-compose up -d --build`

---

#### Test the API by going to (or whatever 'api_port' you supplied earlier):

- `http://localhost:{{cookiecutter.api_port}}/`
  - For a page linking to the following pages.
- `http://localhost:{{cookiecutter.api_port}}/ping`
  - For a simple `pong` response.
- `http://localhost:{{cookiecutter.api_port}}/mongo`
  - For a simple test of the MongoDB connection.

---

#### Run tests (outside of Docker):

1. Create a virtual environment: `python3 -m venv my_venv`
2. Activate virtual environment: `source my_venv/bin/activate`
3. Install requirements: `pip install -r requirements.txt`
4. Run tests: `pytest --verbose`

---

#### What this template will do for you:

1. Create the folder structure for this microservice:

```
|-- app
  \-- main.py (entry point for application)
|-- database (contains all database related code)
|-- routes (contains all routes to be defined)
|-- tests (contains all of the tests)
Dockerfile (build a Docker image based on the API code)
docker-compose.yml (start a container for the API and the MongoDB for this microservice)
```

2. Configure a Dockerfile needed to create an image based on this microservice.

3. Configure the docker-compose.yml file to start the API container and a MongoDB container.

4. Automatically setup the connection between the API and the MongoDB container, inside of `app/main.py`
